{% extends "base.html" %}

{% block title %}Cybercoach Predictions{% endblock %}

{% block content %}

<style>
    p {
        font-family: 'DM Sans', sans-serif;
        font-weight: 700;
        color: white;
    }

    .header-container {
        background-color: #006106;
        border-radius: 20px;
        padding: 10px;
        margin-bottom: 20px;
        text-align: center;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .header-container .group {
        padding: 20px !important;
    }
    
    .group {
        display: block !important;
        border-radius: 15px;
        background-color: #008703;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        text-align: center;
        margin: 10px;
    }

    h1 {
        font-family: 'Fugaz One', sans-serif;
        font-weight: 700;
        color: #FFDE21 !important;
        margin-bottom: 10px;
        text-align: center;
        text-shadow: none !important;
    }

    h2 {
        font-family: 'Fugaz One', sans-serif;
        font-weight: 700;
        color: #FFDE21 !important;
        margin-bottom: 10px;
        margin-top: 10px;
        text-align: center;
        text-shadow: none !important;
    }

    .table-container {
        display: flex;
        justify-content: space-between;
        gap: 20px;
    }

    /* Table wrapper styles */
    .scrollable-table { 
        flex: 1;
        overflow-x: auto;
        width: 100%;
        text-align: center;
        padding-top: 20px;
    }

    /* Table styles */
    .scrollable-table table {
        width: 100%;
        border-collapse: separate; /* Ensures border-radius will work */
        border-spacing: 10px; /* Adds space between table cells */
        background-color: #006106; /* Background for the entire table */
        border-radius: 15px; /* Rounds the corners of the table */
        padding: 10px;
        margin: auto; /* Centers the table */
    }

    /* Header cell styles */
    .scrollable-table th {
        background-color: #008703;
        color: #FFDE21;
        font-family: 'Fugaz One', sans-serif;
        font-size: 18px;
        padding: 10px;
        border-radius: 10px;
        text-transform: uppercase;
    }

    /* Body cell styles */
    .scrollable-table td {
        background-color: #F1EFEF;
        font-family: 'Fugaz One', sans-serif;
        font-weight: 700;
        font-size: 18px;
        padding: 10px;
        border-radius: 10px;
        text-transform: uppercase;
        color: #006106;
    }

    /* Odd rows */
    .scrollable-table tbody tr:nth-of-type(odd) td {
        background-color: #F1EFEF;
        color: #008703;
    }

    /* Even rows */
    .scrollable-table tbody tr:nth-of-type(even) td {
        background-color: #F1EFEF;
        color: #008703;
    }

    /* Styles for special elements */
    .scrollable-table td.correct {
        color: #008703 !important;
        font-weight: bold;
    }

    .scrollable-table td.incorrect {
        color: red !important;
        font-weight: bold;
    }

    @media (max-width: 768px) {
        .table-container {
            flex-direction: column;
        }
    }
    @media (min-width: 769px) {
        .table-container {
            flex-direction: row;
        }
    }
</style>
<div class="header-container">
    <div class="group">
        <h1>{{ coach_name|upper }} CYBERCOACH FOR DRIVE {{ drive_number }} OF {{ current_team|upper }} VS. {{ selected_opponent|upper }} (WEEK {{ selected_week }}, {{ selected_year }})</h1>
    </div>
    <div class="group">
        <p>This Cybercoach is a {{ model_type }} model trained on 80% of {{ coach_name }}'s offensive play calls from the beginning of the {{ first_year }} season to the end of the {{ last_year }} season. 20% of the plays were withheld from the training set in order to be used in the evaluation of the model. This model was <strong>{{ model_accuracy }}%</strong> accurate on the evaluation data set.</p>
        <p>These are the plays that the {{ model_type }} Cybercoach of {{ coach_name }} predicts for that drive.</p>
    </div>
</div>

<div class="table-container" style="background-color:#006106; border-radius: 20px; gap:0px;">
    <div class="group" style="flex: 1 1 40%">
        <h2 id="prediction-stat">THE MACHINE LEARNING MODEL CORRECTLY PREDICTED #/# PLAYS</h2>
    </div>
    <div class="group" style="flex: 1 1 60%">
        <h2>SEE HOW THE REAL DRIVE PLAYED OUT BELOW</h2>
        <p><u>Scroll to the right</u> to see more data for each play.</p>
    </div>
</div>
<div class="table-container">
    <div class="scrollable-table" id="prediction-table" style="flex: 1 1 40%">
        <table border="1">
            <thead>
                <tr>
                    <th>Play #</th>
                    <th>Predicted Play</th>
                    <th>Actual Play</th>
                </tr>
            </thead>
            <tbody>
                {% for pred, actual in predictions_and_actual %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{% if pred == 0 %}Pass{% elif pred == 1 %}Rush{% elif pred == 2 %}Field Goal{% elif pred == 3 %}PAT{% elif pred == 4 %}Punt{% else %}Other{% endif %}</td>
                        <td class="{% if pred == actual %}correct{% else %}incorrect{% endif %}">{% if actual == 0 %}Pass{% elif actual == 1 %}Rush{% elif actual == 2 %}Field Goal{% elif actual == 3 %}PAT{% elif actual == 4 %}Punt{% else %}Other{% endif %}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="scrollable-table" style="flex: 1 1 60%">
        <table border="1">
            <thead>
                <tr>
                    {% if drive_dict %}
                        {% for key in drive_dict.0.keys %}
                            <th>{{ key }}</th>
                        {% endfor %}
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for row in drive_dict %}
                    <tr>
                        {% for value in row.values %}
                            <td>{{ value }}</td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const correctCells = document.querySelectorAll('.correct');
        const incorrectCells = document.querySelectorAll('.incorrect');

        const correctCount = correctCells.length;
        const incorrectCount = incorrectCells.length;
        const totalCells = correctCount + incorrectCount;

        document.getElementById("prediction-stat").innerHTML = "THE MACHINE LEARNING MODEL CORRECTLY PREDICTED " + correctCount + "/" + totalCells + " PLAYS";
    });
</script>

{% endblock %}