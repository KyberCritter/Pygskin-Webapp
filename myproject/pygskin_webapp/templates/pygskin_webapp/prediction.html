{% extends "base.html" %}

{% block title %}Cybercoach Predictions{% endblock %}

{% block content %}

<h1>Cybercoach of {{ coach_name }} {% if first_year == last_year %}({{ first_year }}){% else %}({{ first_year }}-{{ last_year }}){% endif %}</h1>

<h2>Cybercoach Statistics</h2>
<p>This Cybercoach is a {{ model_type }} model trained on 80% of {{ coach_name }}'s offensive play calls from the beginning of the {{ first_year }} season to the end of the {{ last_year }} season. 20% of the plays were withheld from the training set in order to be used in the evaluation of the model. This model was <strong>{{ model_accuracy }}%</strong> accurate on the evaluation data set.</p>
<p>You selected drive {{ drive_number }} of <em>{{ current_team }} vs. {{ selected_opponent }}</em> in week {{ selected_week }} of {{ selected_year }}.</p>
<p>These are the plays that the {{ model_type }} Cybercoach of {{ coach_name }} predicts for that drive.</p>

<h2>Predicted and Actual Play Calls</h2>
<div class="scrollable-table">
    <table border="1">
        <thead>
            <tr>
                <th>Play #</th>
                <th>Predicted</th>
                <th>Actual</th>
                <th>Correct</th>
            </tr>
        </thead>
        <tbody>
            {% for pred, actual in predictions_and_actual %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{% if pred == 0 %}Pass{% elif pred == 1 %}Rush{% elif pred == 2 %}Field Goal{% elif pred == 3 %}PAT{% elif pred == 4 %}Punt{% else %}Other{% endif %}</td>
                    <td>{% if actual == 0 %}Pass{% elif actual == 1 %}Rush{% elif actual == 2 %}Field Goal{% elif actual == 3 %}PAT{% elif actual == 4 %}Punt{% else %}Other{% endif %}</td>
                    <td>{% if pred == actual %}✅{% else %}❌{% endif %}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<h2>Drive Data</h2>
<p>This is all of the data for the selected drive. Not all of the data was used to train the Cybercoach. Certain data, like the play text, are only present to show what plays really happened. Some "plays" from the database, like timeouts, were removed before the training phase. This is responsible for any inconsistent numbering in the "play_number" column.</p>
<p><strong>Scroll to the right</strong> to see more of the data for each play.</p>
<div class="scrollable-table">
    <table>
        <thead>
            <tr>
                {% if drive_dict %}
                    {% for key in drive_dict.0.keys %}
                        <th>{{ key }}</th>
                    {% endfor %}
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for row in drive_dict %}
                <tr>
                    {% for value in row.values %}
                        <td>{{ value }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
